<!DOCTYPE html>
<html>
  <head>
    <title>TEST</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="stylesheet" href="./assets/katex.min.css">
    <!--<link rel="stylesheet" href="./assets/style.css">-->
    <link rel="stylesheet" href="./assets/remark.css">
    <link rel="stylesheet" href="./assets/grid.css">
    </style>
  </head>
  <body>
    <textarea id="source"></textarea>
    <script src="./assets/remark-latest.min.js"></script>
    <!-- <script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>-->
    <script src="./assets/auto-render.min.js"></script>
    <script src="./assets/katex.min.js"></script>
    <script src="./assets/mermaid.js"></script>
    
    <script type="text/javascript">
        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }

        var options = {sourceUrl: getParameterByName("p"),
		       ratio: '16:9',
                       highlightStyle: "default"};
        var renderMath = function() {
            renderMathInElement(document.body, {delimiters: [ // mind the order of delimiters(!?)
                {left: "$$", right: "$$", display: true},
                {left: "$", right: "$", display: false},
                {left: "\\[", right: "\\]", display: true},
                {left: "\\(", right: "\\)", display: false},
            ]});
        }
        var slideshow = remark.create(options, renderMath);

	mermaid.initialize({
		startOnLoad: true,
                cloneCssStyles: false 
	});
	function initMermaid(s) {
	  var diagrams = document.querySelectorAll('.mermaid');
	  var i;
	  for(i=0;i<diagrams.length;i++){
	    if(diagrams[i].offsetWidth>0){
	      mermaid.init(undefined, diagrams[i]);
	    }
	  }
	}
	slideshow.on('afterShowSlide', initMermaid);
	initMermaid(slideshow.getSlides()[slideshow.getCurrentSlideIndex()]);
		
    </script>
  </body>
</html>
